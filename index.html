<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Imóveis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #212A31;
            color: #D3D9D4;
        }
        .card {
            background-color: #2E3944;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            padding: 1.5rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.25);
        }
        .icon { color: #55a3c2; }
        .list-item { display: flex; align-items: flex-start; gap: 0.75rem; }
        .text-accent { color: #55a3c2; }
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: 600;
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transform: scale(1);
        }
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        .btn-primary { background-color: #124E66; }
        .btn-primary:hover { background-color: #1a6288; }
        .btn-secondary { background-color: #748D92; }
        .btn-secondary:hover { background-color: #63777A; }

        /* Estilos para o Modal */
        #detailed-flow-modal, #lightbox-modal {
            transition: opacity 0.3s ease;
        }
        #close-modal-btn {
            font-size: 2.5rem;
            line-height: 1;
            font-weight: bold;
        }
        /* Estilos para o Player de Vídeo Responsivo */
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            max-width: 100%;
            background: #000;
            border-radius: 0.75rem; /* Borda arredondada */
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        /* Estilos para os Cards de Cidade na Home */
        .city-card {
            position: relative;
            background-size: cover;
            background-position: center;
            min-height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .city-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            transition: background-color 0.3s ease;
        }
        .city-card:hover::before {
            background-color: rgba(0, 0, 0, 0.3);
        }
        .city-card h2 {
            position: relative;
            z-index: 10;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
        }
    </style>
</head>
<body class="p-4 sm:p-6">

    <div class="max-w-7xl mx-auto bg-[#2E3944] rounded-2xl shadow-xl p-4 sm:p-8 space-y-6 sm:space-y-8">
        <header id="main-header" class="flex justify-between items-center text-center relative">
            <button id="back-button" class="btn btn-secondary absolute left-0 hidden"><i class="fas fa-arrow-left mr-2"></i> Voltar</button>
            <div class="flex-grow">
                <h1 class="text-2xl sm:text-4xl font-bold text-white mb-1 sm:mb-2">Análise de Imóveis</h1>
                <p id="header-subtitle" class="text-sm sm:text-lg text-gray-200">Visualize e compare as opções de investimento imobiliário</p>
            </div>
            <button id="comparator-button" class="btn btn-primary absolute right-0"><i class="fas fa-balance-scale mr-2"></i> Comparativo</button>
        </header>

        <main id="dashboard-content" class="space-y-6 sm:space-y-8">
            <!-- Conteúdo dinâmico será injetado aqui -->
        </main>
        
        <p class="text-center text-sm text-gray-400 mt-8">Criado por Gabriela Carvalho</p>
    </div>

    <!-- Modal de Fluxo Detalhado -->
    <div id="detailed-flow-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden">
        <div class="card w-full max-w-4xl max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center mb-4 pb-4 border-b border-gray-700">
                <h2 class="text-2xl font-bold text-white">Fluxo de Pagamento Detalhado</h2>
                <button id="close-modal-btn" class="text-gray-400 hover:text-white">&times;</button>
            </div>
            <div id="modal-content" class="overflow-y-auto">
                <!-- Tabela do fluxo será injetada aqui -->
            </div>
        </div>
    </div>
    
    <!-- Lightbox Modal for Images -->
    <div id="lightbox-modal" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center p-4 z-50 hidden">
        <button id="close-lightbox-btn" class="absolute top-4 right-6 text-white text-5xl font-bold z-10">&times;</button>
        <button id="prev-lightbox-btn" class="absolute left-4 text-white text-4xl font-bold p-4">&#10094;</button>
        <img id="lightbox-image" src="" alt="Imagem ampliada do imóvel" class="max-w-[90vw] max-h-[90vh] object-contain">
        <button id="next-lightbox-btn" class="absolute right-4 text-white text-4xl font-bold p-4">&#10095;</button>
    </div>


    <script>
        // --- BANCO DE DADOS (MOCK) ---
        const dadosPorCidade = {'saopaulo':{'prontos':{'on-brooklin':{nome:"ON Brooklin",incorporadora:"Não informado",localizacao:"Brooklin - SP",area:"21 m²",valor:"Por: R$ 354.087,49",valor_de:"De: R$ 406.997,12",rendimento_bruto:"Não informado",mapa_query:"Av.%20Santo%20Amaro%2C%205200%2C%20Brooklin%2C%20S%C3%A3o%20Paulo%2C%20SP",plantas:[{url:"https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/DZI_Humanizada_Final-21.jpg",descricao:"1 dormitório"},{url:"https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/ED-ON-BROOKLIN-18-ao-19-PAV.-FINAL-02.png",descricao:"Studio"},{url:"https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/ED-ON-BROOKLIN-18-ao-19-PAV.-FINAL-24.png",descricao:"Studio (Opção 2)"},{url:"https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/DZI_Humanizada_Final-10.jpg",descricao:"Studio (Opção 3)"}],imagens_url:["https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/DJI_0838-2.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/0M7A0390.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/0M7A0388.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/DJI_0902.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/DJI_0871.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/ACESSO-ELEVADORES_0M7A0225.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/COKITCHEN_0M7A0279-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/COKITCHEN_0M7A0280-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/COKITCHEN_0M7A0283-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/COKITCHEN_0M7A0291-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/CONCIERGE_0M7A0226.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/CONCIERGE_0M7A0233.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/COWORKING-PRO_0M7A0229-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/COWORKING-PRO_0M7A0230.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/COWORKING-PRO_0M7A0245-1.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/COWORKING-PRO_0M7A0243-1.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/COWORKING-PRO_0M7A0239-HDR-1.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/GAMES_0M7A0308-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/GAMES_0M7A0305-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/LAUNDRY-2.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/LAUNDRY.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/MEGA-LOUNGE_0M7A0266-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/MEGA-LOUNGE_0M7A0272-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/TERRACO_0M7A0318-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/TERRACO_DJI_20250130135126_0602_D.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/WELLNESS-BY-LIFE-FITNESS_0M7A0247-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/WELLNESS-BY-LIFE-FITNESS_0M7A0249-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/WELLNESS-BY-LIFE-FITNESS_0M7A0251-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/WELLNESS-BY-LIFE-FITNESS_0M7A0253-HDR.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/DJI_0871.jpg"],descricao_longa:`Localizado no coração do Brooklin, este imóvel pronto para morar oferece uma excelente oportunidade. Com sua localização estratégica na Av. Santo Amaro, o projeto garante acesso rápido ao metrô e a importantes centros comerciais e corporativos. A proximidade a hospitais, parques, universidades e shoppings da região garante alta atratividade para turistas, profissionais e estudantes. É um endereço que combina conveniência urbana, qualidade de vida e um forte potencial de valorização a curto prazo.`,ficha_tecnica:{endereco:"Av. Santo Amaro, 5200",tipologia:"Studio",num_unidades:"Não informado",num_pavimentos:"4° Pavimento",ticket_medio:"Não informado",arquiteto:"Não informado"},geradores_demanda:["200m de caminhada até a Estação Brooklin (Linha Lilás)","06min de caminhada até a Estação Campo Belo (Linha Lilás – integração com futura Linha Ouro do Monotrilho)","07min de carro até o Hospital Santa Paula","09min de carro até o Hospital São Luiz – Unidade Itaim","Fácil acesso ao Hospital Santa Joana, Hospital Santa Catarina e Hospital Albert Einstein (Unidade Vila Mariana)","13min de carro até o Aeroporto de Congonhas","Fácil acesso à Av. dos Bandeirantes, Av. Roberto Marinho, Av. Santo Amaro e Marginal Pinheiros","200m da Av. Roque Petronio Junior;","08min de carro até a Av. Berrini;","800m da Av. Morumbi;","10min de carro até o Parque do Ibirapuera","08min de carro até o Parque Severo Gomes","06min de carro até o Sesc Vila Mariana","07min de carro até a Faculdade Anhembi Morumbi – Campus Vila Olímpia","09min de carro até a FMU – Campus Santo Amaro","10min de carro até a Universidade São Judas – Campus Moema","400m da Novartis Biociências S.A.","05min de carro até o Shopping Morumbi","07min de carro até o Shopping Market Place","09min de carro até o Shopping Vila Olímpia","08min de carro até a Disney, Globo, HBO, Nestlé, HP, Vivo e Bayer;","09min de carro até o Beyond The Club (Primeiro clube de ondas de São Paulo).","Região corporativa e gastronômica sofisticada: Jamie’s Italian, Coco Bambu, Outback, Rascal, Pobre Juan, Bráz Trattoria, Eataly e bares da Av. Juscelino Kubitschek e Vila Olímpia"],rendimento:{diaria_media:"Não informado",faturamento_bruto_mensal:"Não informado"},correcoes:{pos_habite_se:"IGP-M+1% ao mês",despesas_cliente:"Condomínio, IPTU e demais despesas do imóvel são de responsabilidade do cliente."},adicionais:"Pode ter decoração a partir de 70k",video_url:"https://www.youtube.com/watch?v=cHOmhcyvSv8",drive_url:"https://drive.google.com/file/d/1RE2TTyh-2WmuI4_2D92OZbiiEoAnDTJY/view?usp=sharing",ultratour_url:"https://skylineip.s3-sa-east-1.amazonaws.com/Tour+Virtual/Vitacon/On+Brooklin/index.htm",site_url:""}},'em-construcao':{'domingos-morais':{nome:"Domingos de Morais",incorporadora:"Vitacon",localizacao:"Vila Mariana - SP",area:"A partir de 18m²",valor:"A partir de R$ 358.961,46",rendimento_bruto:"R$ 7.440,00",mapa_query:"Rua%20Domingos%20de%20Morais%2C%203093%2C%20Vila%20Mariana%2C%20S%C3%A3o%20Paulo%2C%20SP",plantas:[{url:"https://sitestorage2023.blob.core.windows.net/site-wordpress/2025/05/11-PLA1.jpg",descricao:"Planta 18m²"},{url:"https://sitestorage2023.blob.core.windows.net/site-wordpress/2025/05/Planta-Studio-FINAL-28-3025m2-R00.jpg",descricao:"Planta 30m²"},{url:"https://sitestorage2023.blob.core.windows.net/site-wordpress/2025/05/23-PLA1.jpg",descricao:"Planta 32m²"}],imagens_url:["https://img.apresenta.me/M7ItVksvyNJLMjc3SjUyNU2yTLYwi89JLMhMzsssKtC3MDEyMzc21E-Py0zJySxNss1UMzMzMrVNBgA.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/2891deb6fab8095046455b0f0baf0a21-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/660c7259734e4b9b4fa4b903bd4105ff-7322b43af3be4f010104fab56b3d120a-watermarked.jpeg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/1559af2c4d28203fe45708130f5ed1a8-7322b43af3be4f010104fab56b3d120a-watermarked.jpeg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/baab2869381c281662b7dbf7755a2020-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/f70d24d4971a89b6729cb29408073240-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/bbcdca6ebd5e192386b778274e504952-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/1050f4d81faa13c033f87e0dda60a498-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/d6e3104ca6f0b12b61645d3eb19f5a0f-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/5d420596164c9525e1dd7f617e154f7d-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/24418773b935afe05f46e8b9a1c6a947-7322b43af3be4f010104fab56b3d120a-watermarked.jpeg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/974129c84d47c1a586251ba9cf775bf5-7322b43af3be4f010104fab56b3d120a-watermarked.jpeg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/554c696c522dc56470b53afdcafc928f-7322b43af3be4f010104fab56b3d120a-watermarked.jpeg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/669e9e36d60839f654b0c4f1a84f9bfa-7322b43af3be4f010104fab56b3d120a-watermarked.jpeg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/926a367f42093ab108f52cfd9ce35223-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/d1695f6f34087d73b16c8168db1bac7c-7322b43af3be4f010104fab56b3d120a-watermarked.jpeg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/4e978350f767079027507f3c1a799e61-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/10c26a0abce015ac08874deb59c59867-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/4f39733e1874d7dca9624a0c886191f6-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/4ca0d777b1d264e8860c92f7d907cbe9-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/7046801484bbd293ecd7f9be89d18533-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/cca5bad0097f3c41a1a262378678a11a-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/7603d015ae0a71d0b6a5f86f0b319a0b-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/c74f07795db202530ca0415b790316ed-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/fc953b6f789e8ae56903377c4a894485-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/9ba858762baa1240c9c9d22773e3c998-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/511f600c28855d5b2eff4c8eba8b9281-7322b43af3be4f010104fab56b3d120a-watermarked.jpeg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/2580d654cef1b051958c12ab2b2d2943-7322b43af3be4f010104fab56b3d120a-watermarked.jpeg"],descricao_longa:`Localizado em um dos eixos mais conectados da zona sul de São Paulo, este imóvel no cruzamento da Rua Domingos de Morais com a Rua Luís Góes oferece uma excelente oportunidade para quem busca investir no crescente mercado de short stay urbano. Com alta circulação de turistas e executivos, acesso rápido ao metrô, comércio abundante e uma vizinhança em constante valorização, o ponto se destaca pela combinação de praticidade, segurança e infraestrutura. A poucos minutos da Av. Paulista, centros de eventos e polos corporativos, o imóvel apresenta forte potencial de ocupação e diárias elevadas — com projeções acima da média do mercado. Ideal para investidores que buscam rentabilidade com operação enxuta e valorização imobiliária garantida por localização estratégica.`,ficha_tecnica:{endereco:"RUA DOMINGOS DE MORAIS, 3.093 X RUA LUÍS GÓIS, 876",tipologia:"Studios",num_pavimentos:"17",ticket_medio:"R$ 373.584,21",arquiteto:"MCAA ARQUITETOS"},geradores_demanda:["Educação e cultura: bairro abriga instituições como UNIFESP, ESPM, Faculdade de Belas Artes, Cinemateca e SESC, atraindo acadêmicos, professores, estudantes e público nos eventos dessas instituições.","Hospitais de referência: Hospital Santa Cruz, Hospital Sepaco e Dante Pazzanese geram demanda de familiares e pacientes em tratamento prolongado.","Mobilidade excepcional: diversas estações de metrô (Ana Rosa, Vila Mariana, Santa Cruz), fácil acesso à Avenida Paulista e outras regiões da cidade.","Qualidade de vida e ambiente residencial: bairro arborizado, calmo e seguro — ideal para estadias tranquilas.","Proximidade ao Parque do Ibirapuera: um dos maiores e mais visitados parques da cidade, ponto de lazer, caminhadas e cultura."],rendimento:{diaria_media:"R$ 310,00",faturamento_bruto_mensal:"R$ 7.440,00"},video_url:"https://www.youtube.com/watch?v=XP46RGNhgWY",drive_url:"https://drive.google.com/file/d/1-4FbACvstn1Fz1clj5MPj3HdTW02ydmm/view?usp=sharing",images_url:"https://drive.google.com/drive/folders/1hMCTFeuFL5VaL4kFeAO7Mi30bhnxxJCs?usp=drive_link",site_url:""},'pinheiros':{nome:"Vitacon Pinheiros",incorporadora:"Vitacon",localizacao:"Pinheiros - SP",area:"A partir de 18m²",valor:"A partir de R$ 490.000,00",rendimento_bruto:"R$ 7.875,00",video_url:"https://www.youtube.com/watch?v=-MY0k4nYr84",mapa_query:"R.%20Heitor%20Penteado%2C%20177%20-%20Pinheiros%2C%20S%C3%A3o%20Paulo%20-%20SP%2C%2005437-000",adicionais:"Ainda não temos tabela por ser pré lançamento, é uma linha de preço, em caso de interesse, consultar.",correcoes:{obra:"INCC durante a obra",pos_habite_se:"IGP-M+1% após Habite-se",despesas_cliente:"Despesas de condomínio, IPTU e demais despesas do imóvel é de responsabilidade do cliente."},plantas:[{url:"https://sitestorage2023.blob.core.windows.net/site-wordpress/2025/04/12_Planta-ilustrativa-do-Studio-de-2007-m%C2%B2.jpg",descricao:"Planta 20m²"},{url:"https://sitestorage2023.blob.core.windows.net/site-wordpress/2025/04/01_Planta-ilustrativa-do-Studio-de-2633-m%C2%B2.jpg",descricao:"Planta 26m²"},{url:"https://sitestorage2023.blob.core.windows.net/site-wordpress/2025/04/10_Planta-ilustrativa-do-Studio-de-2651-m%C2%B2.jpg",descricao:"Planta 26m² (Opção 2)"},{url:"https://sitestorage2023.blob.core.windows.net/site-wordpress/2025/04/04_Planta-ilustrativa-do-Studio-de-3752-m%C2%B2.jpg",descricao:"Planta 37m²"}],imagens_url:["https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/6efef282cb2dd279701e697bcec65f86-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/477c671b4da39d3e18b61b13c1dafec1-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/8c550371310790e72d43c2c446f4b55f-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/5418c9ae3430dcd44f2c17bb94787da2-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/ab3dfd8d1887063c2a0356efb198d686-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/6aac06433ead849d6aa48a17559c63de-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/16dde4867f0b83b793932bb9f73396f0-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/2462673f57f51355fe839698cc16ff94-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/9923feba3165d9ce921f5f4c4f7ccad3-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/ec55eb45bafc407e309b1e71d3daad0a-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/587a891e82c6b31fff2a04ec6c21e45a-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/03230dad5221c30e6f1e46930b9f9188-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/033d515f9f734d66f397297eb5b92350-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/5f15a150fb07d4ecf4113be42a9136b6-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/381f9cb3ec4a020b81ee68ffaedbec7d-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/1b6d7617df0dcb20089b3f257e4c8c97-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/1ae8f67c9a291c3f79eec1de155ce827-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/68cc4cf530364170534df41ad0a8c89a-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/0ac7e926c234319838a11acf18ae56ce-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/39a00f16c94ad109420267b8e414720f-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/cdfc258ae1e2a07d6401e70cf90c05ea-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/691d81d03c41b896c3db439a4ad5b159-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/03/DZI_Humanizada_Final-10.jpg"],descricao_longa:`Conectado por importantes vias, como Av. Doutor Arnaldo, Av. Rebouças e R. Oscar Freire. Cercado pelos bairros Vila Madalena, Perdizes e Jardins`,ficha_tecnica:{endereco:"R. Heitor Penteado, 177 - Pinheiros, São Paulo - SP, 05437-000",tipologia:"Studios",num_pavimentos:"Não informado",ticket_medio:"Não informado",arquiteto:"Não informado"},geradores_demanda:["150 metros do Futuro Cyrella Corporate By Pininfarina","Esquina com a Rua Capote Valente","220m de caminhada até a Rua Oscar Freire","12min de carro até a Av.Paulista","600m de caminhada até o Metrô Sumaré","07min de carro até o Metrô Oscar Freire","900m de caminhada até o Sancta Maggiore","09min de carro até o Hospital das Clínicas FMUSP","10min de carro até o INCOR","750m de caminhada até o Colégio Notre Dame","07min de carro até o St. Francis College","08min de carro até a USP","09min de carro até o Instituto Tomie Ohtake","10min de carro até o Centro Universitário - FAM","12min de carro até o Shopping Cidade São Paulo","08min de carro até o Estádio Pacaembu","11min de carro até o Allianz Parque","04min de carro até o Beco do Batman","05min de carro até o Restaurante Metzi","06min de carro até o Restaurante Pé de Manga","09min de carro até o Restaurante Jacarandá"],rendimento:{diaria_media:"R$ 350,00",faturamento_bruto_mensal:"R$ 7.875,00"},drive_url:"https://drive.google.com/file/d/1y4P2Zo2tVByJxVBqE2CjQSPYtBfCyqr4/view?usp=sharing",site_url:""},'the-collection':{nome:"The Collection Vila Mariana",incorporadora:"Trisul",localizacao:"Vila Mariana - SP",area:"A partir de 25m²",valor:"A partir de R$ 350.833,00",rendimento_bruto:"R$ 7.440,00",descricao_longa:`No coração da Vila Mariana, nasce mais um símbolo de harmonia, sofisticação e inteligência imobiliária: o The Collection Vila Mariana, da Trisul. Com torre única e arquitetura contemporânea, o projeto reúne design moderno, rooftop com área de lazer completa e espaços planejada para uma vida urbana plena e conectada. Sua localização estratégica oferece fácil acesso ao metrô (a apenas 500 metros), universidades renomadas, escolas de ponta, hospitais, centros culturais, gastronomia diversificada e comércio pulsante. É um endereço que combina conveniência, valorização contínua e forte atratividade para turistas, profissionais em trânsito e estudantes, garantindo alta demanda e potencial de valorização patrimonial no curto e longo prazo. Os ambientes foram pensados para oferecer máxima funcionalidade, adaptando-se ao estilo de vida moderno e às exigências do público que busca experiências urbanas com conforto e praticidade.`,ficha_tecnica:{endereco:"Rua Professor Sud Mennucci, 165",tipologia:"studios, 1 e 2 quartos",num_unidades:"122 (NR)",num_pavimentos:"21",ticket_medio:"R$ 481.010,50",arquiteto:"LE Arquitetos"},geradores_demanda:["Mobilidade estratégica: metrô Santa Cruz (500 m), Vila Mariana e Ana Rosa, fácil acesso à Av. Paulista, Av. 23 de Maio e Aeroporto de Congonhas.","Lazer e cultura: Parque Ibirapuera a 7 min além de SESC Vila Mariana, cinemas, teatros e ciclovias.","Saúde: Hospitais Santa Cruz, São Paulo, Santa Joana, Beneficência Portuguesa e HCor.","Educação: Universidades e escolas renomadas: ESPM, Belas Artes, Colégio Madre Cabrini, ETAPA.","Gastronomia: Restaurantes e bares icônicos como Veloso Bar, Fornace e Vista Ibirapuera."],rendimento:{diaria_media:"R$ 310,00",faturamento_bruto_mensal:"R$ 7.440,00"},video_url:"",drive_url:"",site_url:""},'lorena':{nome:"Vitacon Lorena",incorporadora:"Vitacon",localizacao:"Jardins - SP",area:"A partir de 19,51m²",valor:"A partir de R$ 630.823,04",rendimento_bruto:"R$ 7.440,00",mapa_query:"Alameda%20Lorena%2C%202158%2C%20Jardins%2C%20S%C3%A3o%20Paulo%2C%20SP",plantas:[{url:"https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/02/PLANTA-5%C2%B0-PAVIMENTO-FINAL-1-4668m%C2%B2.jpg",descricao:"2 dorms - 47m²"},{url:"https://sitestorage2023.blob.core.windows.net/site-wordpress/2023/02/PLANTA-12%C2%B0-PAVIMENTO-FINAL-1-13071m%C2%B2.jpg",descricao:"1 dorm - 130m²"}],imagens_url:["https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/5074486e3cf3c6399f9b1410b39a7188-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/bbc765ef822795832ec1fa613a987c38-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/3b54b44587281d5b10a76ffed97e1257-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/666fc11eddea88abc09c30754d22379b-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/7209ccf8bb94c71b7893b43d31a67324-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/1ee24e2a4dcb14878686d8259b4b4151-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/61d3abd399efed2ca77b0643be45f12d-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/0b3c3414e40c269ea31bb7ba17bc5d40-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/e1464295684877d50c70417b444e8d8a-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/c49bef61d33191c992df64da641d6c51-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/212dba7a6cc9ee376bc36589cbad1738-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/b4afd83179642b9f1626b27ca4ad6e63-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/a0034b6ba1325fe00b6b312da8d76ce7-7322b43af3be4f010104fab56b3d120a-watermarked.jpg","https://cms.vitacon.com.br/wp-content/uploads/empreendimento_images/8cdaece545e49c18e51fe5be6263951f-7322b43af3be4f010104fab56b3d120a-watermarked.jpg"],video_url:"https://www.youtube.com/watch?v=JfFjClbA-3Q",ultratour_url:"https://skylineip.s3.sa-east-1.amazonaws.com/Tour+Virtual/Vitacon/On+Lorena+II/index.htm",drive_url:"https://drive.google.com/file/d/1Vvu0sQSTKqbrzQRJPElycHb4y3kvWLSD/view?usp=sharing",descricao_longa:`Localizado no coração gastronômico dos Jardins: ao redor estão Lellis Trattoria, Paris 6, Santo Grão, A Figueira Rubaiyat, Kouzina, Le Jazz, Nino Cucina, além de diversos cafés, rooftops e boutiques renomadas.`,ficha_tecnica:{endereco:"Alameda Lorena, 2158",tipologia:"Não Informado",num_unidades:"Não Informado",num_pavimentos:"Não Informado",ticket_medio:"Não Informado",arquiteto:"Não Informado"},geradores_demanda:["500m de caminhada até a Estação Oscar Freire (Linha Amarela)","09min de caminhada até a Estação Clínicas (Linha Verde)","05min de carro até o Hospital das Clínicas","07min de carro até o Hospital Sírio-Libanês","Fácil acesso ao Hospital Nove de Julho, Hospital Santa Catarina e HCor","18min de carro até o Aeroporto de Congonhas","Fácil acesso à Av. Rebouças, Av. Brasil, Rua Estados Unidos e Av. Paulista","08min de carro até o Parque do Ibirapuera","10min de carro até o Parque Buenos Aires","06min de carro até o Sesc Avenida Paulista","06min de carro até a Universidade Mackenzie","09min de carro até a ESPM","11min de carro até a FAAP","02min de caminhada até a Rua Oscar Freire","06min de carro até o Shopping Cidade São Paulo","09min de carro até o Shopping Pátio Paulista","04min de carro até o Beco do Batman","05min de carro até o Restaurante Metzi","06min de carro até o Restaurante Pé de Manga","09min de carro até o Restaurante Jacarandá"],rendimento:{diaria_media:"R$ 310,00",faturamento_bruto_mensal:"R$ 7.440,00"},site_url:""}}},'goiania':{'prontos':{},'em-construcao':{'smart-36':{nome:"Smart 36",incorporadora:"EBM Incorporadora",localizacao:"Setor Bueno - Goiânia/GO",area:"A partir de 35m²",valor:"A partir de R$ 462.425,94",rendimento_bruto:"R$ 9.240,00",descricao_longa:`O Smart 36 foi projetado para unir modernidade, praticidade e rentabilidade em um único endereço. Localizado em uma região estratégica de Goiânia, no Setor Bueno, o empreendimento oferece unidades compactas e inteligentes, ideais para o público jovem, profissionais em mobilidade e turistas que buscam conforto aliado à conveniência. Com infraestrutura completa, áreas de lazer funcionais e tipologias versáteis, o Smart 36 se posiciona como uma excelente oportunidade de investimento no mercado imobiliário goianiense, especialmente no segmento de short stay, que cresce a cada ano impulsionado pelo turismo de lazer e negócios.`,ficha_tecnica:{endereco:"R. T-36, 3612 - St. Bueno, Goiânia - GO, 74223-052",tipologia:"Studios, 1 e 2 quartos",num_torres:"02 (residenciais)",num_unidades:"408",num_pavimentos:"26",ticket_medio:"R$ 472.129,80"},geradores_demanda:["Campus da UFG  – movimentação frequente de estudantes e servidores públicos na região, sobretudo para compromissos acadêmicos ou administrativos.","Parque Vaca Brava – zona de lazer com eventos, trilhas e áreas ao ar livre, muito valorizada por famílias e visitantes.","Goiânia Shopping – alta circulação para compras, alimentação e serviços, atraindo turistas e viajantes de negócios.","Gastronomia e vida urbana – ampla oferta de bares, cafés, restaurantes de renome, agregando valor à experiência do visitante.","Infraestrutura robusta – serviços completos a proximidade que atraem quem busca moradia temporária com conforto.","Logística e mobilidade – fácil acesso às principais vias da cidade, melhor conectividade para quem transita a trabalho ou lazer."],rendimento:{diaria_media:"R$420,00",faturamento_bruto_mensal:"R$ 9.240,00"},cronograma_obras:{previsao_entrega:"01/2028"},correcoes:{obra:"INCC durante a obra",pos_habite_se:"IGP-M+1% após Habite-se"},video_url:"https://maps.app.goo.gl/dsN5bdLYTf9mhZob6",drive_url:"",site_url:""},'maua':{nome:"Mauá",incorporadora:"FR Incorporadora",localizacao:"Setor Rodoviário - Goiânia/GO",area:"A partir de 60m²",valor:"A partir de R$ 387.941,01",rendimento_bruto:"R$ 4.840,00",descricao_longa:`O Mauá FR nasce para transformar o cotidiano em uma experiência elevada de conforto, lazer e bem-estar. Localizado em frente ao Shopping Cerrado e próximo à Avenida Leste-Oeste, no Setor Rodoviário em Goiânia, o empreendimento une a conveniência da mobilidade urbana com a exclusividade de um projeto moderno e sofisticado. Com torre única, apartamentos funcionais e áreas de lazer panorâmicas — incluindo rooftop com academia, espaços gourmet e piscina — o Mauá é a escolha perfeita para quem busca morar bem ou investir em um ativo sólido, que combina qualidade construtiva, segurança e valorização.`,ficha_tecnica:{endereco:"Rua Barão de Mauá, Q.09, L.08, Setor Rodoviário – Goiânia/GO",tipologia:"2 e 3 quartos",num_unidades:"212",num_pavimentos:"30",arquiteto:"Alexandre Leite Terra"},geradores_demanda:["Shopping Cerrado (em frente ao empreendimento), polo de lazer, compras e gastronomia.","Terminal Rodoviário de Goiânia, que conecta a cidade a todo o estado e ao país.","Hospitais e clínicas próximos, atraindo acompanhantes e pacientes de outras cidades.","Universidades da região (PUC Goiás, UFG, Faculdades privadas).","Eventos e negócios, impulsionados por centros de convenções e feiras em Goiânia.","Mobilidade estratégica: fácil acesso pela Avenida Leste-Oeste e conexões rápidas ao centro e demais bairros."],rendimento:{diaria_media:"R$220,00",faturamento_bruto_mensal:"R$ 4.840,00"},cronograma_obras:{previsao_entrega:"11/2028"},video_url:"https://maps.app.goo.gl/7vzKHJP5Pf7G98sn7",drive_url:"",site_url:""}}}};
        const dadosCalculadora = {'domingos-morais':{fluxos:[{nome:"Unidade 18,06 m²",info_unidade:"Ref: U0247",pagamentos:[{valor:36718.56,data:new Date("2025-09-01"),descricao:"Ato"},{valor:6119.76,data:new Date("2025-10-01"),descricao:"Sinal"},{valor:6119.76,data:new Date("2025-11-01"),descricao:"Sinal"},{valor:6119.76,data:new Date("2025-12-01"),descricao:"Sinal"},...Array(33).fill(null).map((_,i)=>({valor:556.34,data:new Date(2026,i,1),descricao:`Mensal (${i+1}/33)`})),{valor:6119.76,data:new Date("2026-09-01"),descricao:"Anual (1/3)"},{valor:6119.76,data:new Date("2027-09-01"),descricao:"Anual (2/3)"},{valor:6119.76,data:new Date("2028-09-01"),descricao:"Anual (3/3)"},{valor:18359.28,data:new Date("2028-10-01"),descricao:"Única"},{valor:256662.71,data:new Date("2028-11-01"),descricao:"Financiamento"},{valor:367.19,data:new Date("2028-12-01"),descricao:"Periodicidade"}]},{nome:"Unidade 30,32 m²",info_unidade:"Ref: U1229",pagamentos:[{valor:50562.37,data:new Date("2025-09-01"),descricao:"Ato"},{valor:8427.06,data:new Date("2025-10-01"),descricao:"Sinal"},{valor:8427.06,data:new Date("2025-11-01"),descricao:"Sinal"},{valor:8427.06,data:new Date("2025-12-01"),descricao:"Sinal"},...Array(33).fill(null).map((_,i)=>({valor:766.1,data:new Date(2026,i,1),descricao:`Mensal (${i+1}/33)`})),{valor:8427.06,data:new Date("2026-09-01"),descricao:"Anual (1/3)"},{valor:8427.06,data:new Date("2027-09-01"),descricao:"Anual (2/3)"},{valor:8427.06,data:new Date("2028-09-01"),descricao:"Anual (3/3)"},{valor:25281.18,data:new Date("2028-10-01"),descricao:"Única"},{valor:353430.94,data:new Date("2028-11-01"),descricao:"Financiamento"},{valor:505.62,data:new Date("2028-12-01"),descricao:"Periodicidade"}]},{nome:"Unidade 32,98 m²",info_unidade:"Ref: U0206",pagamentos:[{valor:49007.65,data:new Date("2025-09-01"),descricao:"Ato"},{valor:8167.94,data:new Date("2025-10-01"),descricao:"Sinal"},{valor:8167.94,data:new Date("2025-11-01"),descricao:"Sinal"},{valor:8167.94,data:new Date("2025-12-01"),descricao:"Sinal"},...Array(33).fill(null).map((_,i)=>({valor:742.54,data:new Date(2026,i,1),descricao:`Mensal (${i+1}/33)`})),{valor:8167.94,data:new Date("2026-09-01"),descricao:"Anual (1/3)"},{valor:8167.94,data:new Date("2027-09-01"),descricao:"Anual (2/3)"},{valor:8167.94,data:new Date("2028-09-01"),descricao:"Anual (3/3)"},{valor:24503.82,data:new Date("2028-10-01"),descricao:"Única"},{valor:342563.45,data:new Date("2028-11-01"),descricao:"Financiamento"},{valor:490.08,data:new Date("2028-12-01"),descricao:"Periodicidade"}]}] },pinheiros:{fluxos:[{nome:"Unidade 18m²",info_unidade:"Sugestão de pagamento",pagamentos:[{valor:49e3,data:new Date("2025-09-01"),descricao:"Entrada"},{valor:8166.67,data:new Date("2025-10-01"),descricao:"Sinal (1/3)"},{valor:8166.67,data:new Date("2025-11-01"),descricao:"Sinal (2/3)"},{valor:8166.67,data:new Date("2025-12-01"),descricao:"Sinal (3/3)"},...Array.from({length:35},(_,i)=>{const t=new Date("2026-01-01").getMonth()+i,e=new Date("2026-01-01").getFullYear()+Math.floor(t/12);return{valor:700,data:new Date(e,t%12,1),descricao:`Mensal (${i+1}/35)`}}),{valor:8166.67,data:new Date("2026-09-01"),descricao:"Anual (1/3)"},{valor:8166.67,data:new Date("2027-09-01"),descricao:"Anual (2/3)"},{valor:8166.67,data:new Date("2028-09-01"),descricao:"Anual (3/3)"},{valor:24500,data:new Date("2028-11-01"),descricao:"Única"},{valor:342510,data:new Date("2028-12-01"),descricao:"Financiamento"},{valor:490,data:new Date("2029-01-01"),descricao:"Periodicidade"}]}] },'the-collection':{fluxos:[{nome:"Exemplo de Unidade",info_unidade:"A partir de 25m²",pagamentos:[{valor:35896.15,data:new Date('2025-09-01'),descricao:"Entrada"},{valor:5892.69,data:new Date('2025-10-01'),descricao:"Sinal"},{valor:5892.69,data:new Date('2025-11-01'),descricao:"Sinal"},{valor:5892.69,data:new Date('2025-12-01'),descricao:"Sinal"},{valor:498.56,data:new Date('2026-01-01'),descricao:"Mensal (1/36)"},{valor:498.56,data:new Date('2026-02-01'),descricao:"Mensal (2/36)"},{valor:498.56,data:new Date('2026-03-01'),descricao:"Mensal (3/36)"},{valor:498.56,data:new Date('2026-04-01'),descricao:"Mensal (4/36)"},{valor:498.56,data:new Date('2026-05-01'),descricao:"Mensal (5/36)"},{valor:498.56,data:new Date('2026-06-01'),descricao:"Mensal (6/36)"},{valor:498.56,data:new Date('2026-07-01'),descricao:"Mensal (7/35)"},{valor:498.56,data:new Date('2026-08-01'),descricao:"Mensal (8/36)"},{valor:5892.69,data:new Date('2026-09-01'),descricao:"Anual (1/3)"},{valor:498.56,data:new Date('2026-09-01'),descricao:"Mensal (9/36)"},{valor:498.56,data:new Date('2026-10-01'),descricao:"Mensal (10/36)"},{valor:498.56,data:new Date('2026-11-01'),descricao:"Mensal (11/36)"},{valor:498.56,data:new Date('2026-12-01'),descricao:"Mensal (12/36)"},{valor:498.56,data:new Date('2027-01-01'),descricao:"Mensal (13/36)"},{valor:498.56,data:new Date('2027-02-01'),descricao:"Mensal (14/36)"},{valor:498.56,data:new Date('2027-03-01'),descricao:"Mensal (15/36)"},{valor:498.56,data:new Date('2027-04-01'),descricao:"Mensal (16/36)"},{valor:498.56,data:new Date('2027-05-01'),descricao:"Mensal (17/36)"},{valor:498.56,data:new Date('2027-06-01'),descricao:"Mensal (18/36)"},{valor:498.56,data:new Date('2027-07-01'),descricao:"Mensal (19/36)"},{valor:498.56,data:new Date('2027-08-01'),descricao:"Mensal (20/36)"},{valor:5892.69,data:new Date('2027-09-01'),descricao:"Anual (2/3)"},{valor:498.56,data:new Date('2027-09-01'),descricao:"Mensal (21/36)"},{valor:498.56,data:new Date('2027-10-01'),descricao:"Mensal (22/36)"},{valor:498.56,data:new Date('2027-11-01'),descricao:"Mensal (23/36)"},{valor:498.56,data:new Date('2027-12-01'),descricao:"Mensal (24/36)"},{valor:498.56,data:new Date('2028-01-01'),descricao:"Mensal (25/36)"},{valor:498.56,data:new Date('2028-02-01'),descricao:"Mensal (26/36)"},{valor:498.56,data:new Date('2028-03-01'),descricao:"Mensal (27/36)"},{valor:498.56,data:new Date('2028-04-01'),descricao:"Mensal (28/36)"},{valor:498.56,data:new Date('2028-05-01'),descricao:"Mensal (29/36)"},{valor:498.56,data:new Date('2028-06-01'),descricao:"Mensal (30/36)"},{valor:498.56,data:new Date('2028-07-01'),descricao:"Mensal (31/36)"},{valor:498.56,data:new Date('2028-08-01'),descricao:"Mensal (32/36)"},{valor:17948.07,data:new Date('2028-10-01'),descricao:"Única"},{valor:295201.94,data:new Date('2028-11-01'),descricao:"Financiamento"},{valor:350.83,data:new Date('2028-12-01'),descricao:"Periodicidade"}]}] },'lorena':{fluxos:[{nome:"Unidade: U-0303",info_unidade:"Área Privativa: 19,51m²",pagamentos:[{valor:63082.29,data:new Date('2025-09-01'),descricao:"Ato"},{valor:10513.72,data:new Date('2025-10-01'),descricao:"Sinal (1/3)"},{valor:10513.72,data:new Date('2025-11-01'),descricao:"Sinal (2/3)"},{valor:10513.72,data:new Date('2025-12-01'),descricao:"Sinal (3/3)"},{valor:15770.58,data:new Date('2026-01-01'),descricao:"Mensal (1/4)"},{valor:15770.58,data:new Date('2026-02-01'),descricao:"Mensal (2/4)"},{valor:15770.58,data:new Date('2026-03-01'),descricao:"Mensal (3/4)"},{valor:15770.58,data:new Date('2026-04-01'),descricao:"Mensal (4/4)"},{valor:31541.15,data:new Date('2026-06-01'),descricao:"Anual (1/1)"},{valor:31541.15,data:new Date('2026-04-01'),descricao:"Única"},{valor:409404.15,data:new Date('2026-05-01'),descricao:"Financiamento"},{valor:630.82,data:new Date('2028-07-01'),descricao:"Periodicidade"}]}] },'on-brooklin':{fluxos:[{nome:"Unidade: R2V-0413",info_unidade:"4° Pavimento | Área: 21 m²",pagamentos:[{valor:354087.49,data:new Date('2025-09-01'),descricao:"Valor à vista"}]}] },'smart-36':{fluxos:[{nome:"Unidade: Exemplo",info_unidade:"Área: 35 m²",pagamentos:[{valor:39533.81,data:new Date('2025-09-01'),descricao:"Entrada"},{valor:6588.97,data:new Date('2025-10-01'),descricao:"Sinal"},{valor:6588.97,data:new Date('2025-11-01'),descricao:"Sinal"},{valor:6588.97,data:new Date('2025-12-01'),descricao:"Sinal"},{valor:599,data:new Date('2026-01-01'),descricao:"Mensal (1/33)"},{valor:599,data:new Date('2026-02-01'),descricao:"Mensal (2/33)"},{valor:599,data:new Date('2026-03-01'),descricao:"Mensal (3/33)"},{valor:599,data:new Date('2026-04-01'),descricao:"Mensal (4/33)"},{valor:599,data:new Date('2026-05-01'),descricao:"Mensal (5/33)"},{valor:599,data:new Date('2026-06-01'),descricao:"Mensal (6/33)"},{valor:599,data:new Date('2026-07-01'),descricao:"Mensal (7/33)"},{valor:599,data:new Date('2026-08-01'),descricao:"Mensal (8/33)"},{valor:6588.97,data:new Date('2026-09-01'),descricao:"Anual (1/3)"},{valor:599,data:new Date('26-09-01'),descricao:"Mensal (9/33)"},{valor:599,data:new Date('2026-10-01'),descricao:"Mensal (10/33)"},{valor:599,data:new Date('2026-11-01'),descricao:"Mensal (11/33)"},{valor:599,data:new Date('2026-12-01'),descricao:"Mensal (12/33)"},{valor:599,data:new Date('2027-01-01'),descricao:"Mensal (13/33)"},{valor:599,data:new Date('2027-02-01'),descricao:"Mensal (14/33)"},{valor:599,data:new Date('2027-03-01'),descricao:"Mensal (15/33)"},{valor:599,data:new Date('2027-04-01'),descricao:"Mensal (16/33)"},{valor:599,data:new Date('2027-05-01'),descricao:"Mensal (17/33)"},{valor:599,data:new Date('2027-06-01'),descricao:"Mensal (18/33)"},{valor:599,data:new Date('2027-07-01'),descricao:"Mensal (19/33)"},{valor:599,data:new Date('2027-08-01'),descricao:"Mensal (20/33)"},{valor:6588.97,data:new Date('2027-09-01'),descricao:"Anual (2/3)"},{valor:599,data:new Date('2027-09-01'),descricao:"Mensal (21/33)"},{valor:599,data:new Date('2027-10-01'),descricao:"Mensal (22/33)"},{valor:599,data:new Date('2027-11-01'),descricao:"Mensal (23/33)"},{valor:599,data:new Date('2027-12-01'),descricao:"Mensal (24/33)"},{valor:599,data:new Date('2028-01-01'),descricao:"Mensal (25/33)"},{valor:599,data:new Date('2028-02-01'),descricao:"Mensal (26/33)"},{valor:599,data:new Date('2028-03-01'),descricao:"Mensal (27/33)"},{valor:599,data:new Date('2028-04-01'),descricao:"Mensal (28/33)"},{valor:599,data:new Date('2028-05-01'),descricao:"Mensal (29/33)"},{valor:599,data:new Date('2028-06-01'),descricao:"Mensal (30/33)"},{valor:599,data:new Date('2028-07-01'),descricao:"Mensal (31/33)"},{valor:599,data:new Date('2028-08-01'),descricao:"Mensal (32/33)"},{valor:6588.97,data:new Date('2028-09-01'),descricao:"Anual (3/3)"},{valor:599,data:new Date('2028-09-01'),descricao:"Mensal (33/33)"},{valor:19766.9,data:new Date('2028-10-01'),descricao:"Única"},{valor:276341.23,data:new Date('2028-11-01'),descricao:"Financiamento"},{valor:395.34,data:new Date('2028-12-01'),descricao:"Periodicidade"}]}] },'maua':{fluxos:[{nome:"Unidade: Exemplo",info_unidade:"Área: 60 m²",pagamentos:[{valor:39533.81,data:new Date('2025-09-01'),descricao:"Entrada"},{valor:6588.97,data:new Date('2025-10-01'),descricao:"Sinal"},{valor:6588.97,data:new Date('2025-11-01'),descricao:"Sinal"},{valor:6588.97,data:new Date('2025-12-01'),descricao:"Sinal"},{valor:599,data:new Date('2026-01-01'),descricao:"Mensal (1/33)"},{valor:599,data:new Date('2026-02-01'),descricao:"Mensal (2/33)"},{valor:599,data:new Date('2026-03-01'),descricao:"Mensal (3/33)"},{valor:599,data:new Date('2026-04-01'),descricao:"Mensal (4/33)"},{valor:599,data:new Date('2026-05-01'),descricao:"Mensal (5/33)"},{valor:599,data:new Date('2026-06-01'),descricao:"Mensal (6/33)"},{valor:599,data:new Date('2026-07-01'),descricao:"Mensal (7/33)"},{valor:599,data:new Date('2026-08-01'),descricao:"Mensal (8/33)"},{valor:6588.97,data:new Date('2026-09-01'),descricao:"Anual (1/3)"},{valor:599,data:new Date('2026-09-01'),descricao:"Mensal (9/33)"},{valor:599,data:new Date('2026-10-01'),descricao:"Mensal (10/33)"},{valor:599,data:new Date('2026-11-01'),descricao:"Mensal (11/33)"},{valor:599,data:new Date('2026-12-01'),descricao:"Mensal (12/33)"},{valor:599,data:new Date('2027-01-01'),descricao:"Mensal (13/33)"},{valor:599,data:new Date('2027-02-01'),descricao:"Mensal (14/33)"},{valor:599,data:new Date('2027-03-01'),descricao:"Mensal (15/33)"},{valor:599,data:new Date('2027-04-01'),descricao:"Mensal (16/33)"},{valor:599,data:new Date('2027-05-01'),descricao:"Mensal (17/33)"},{valor:599,data:new Date('2027-06-01'),descricao:"Mensal (18/33)"},{valor:599,data:new Date('2027-07-01'),descricao:"Mensal (19/33)"},{valor:599,data:new Date('2027-08-01'),descricao:"Mensal (20/33)"},{valor:6588.97,data:new Date('2027-09-01'),descricao:"Anual (2/3)"},{valor:599,data:new Date('2027-09-01'),descricao:"Mensal (21/33)"},{valor:599,data:new Date('2027-10-01'),descricao:"Mensal (22/33)"},{valor:599,data:new Date('2027-11-01'),descricao:"Mensal (23/33)"},{valor:599,data:new Date('2027-12-01'),descricao:"Mensal (24/33)"},{valor:599,data:new Date('2028-01-01'),descricao:"Mensal (25/33)"},{valor:599,data:new Date('2028-02-01'),descricao:"Mensal (26/33)"},{valor:599,data:new Date('2028-03-01'),descricao:"Mensal (27/33)"},{valor:599,data:new Date('2028-04-01'),descricao:"Mensal (28/33)"},{valor:599,data:new Date('2028-05-01'),descricao:"Mensal (29/33)"},{valor:599,data:new Date('2028-06-01'),descricao:"Mensal (30/33)"},{valor:599,data:new Date('2028-07-01'),descricao:"Mensal (31/33)"},{valor:599,data:new Date('2028-08-01'),descricao:"Mensal (32/33)"},{valor:6588.97,data:new Date('2028-09-01'),descricao:"Anual (3/3)"},{valor:599,data:new Date('2028-09-01'),descricao:"Mensal (33/33)"},{valor:19766.9,data:new Date('2028-10-01'),descricao:"Única"},{valor:276341.23,data:new Date('2028-11-01'),descricao:"Financiamento"},{valor:395.34,data:new Date('2028-12-01'),descricao:"Periodicidade"}]}] }};

        // --- VARIÁVEIS DE ESTADO E ELEMENTOS DO DOM ---
        const dashboardContent = document.getElementById('dashboard-content');
        const backButton = document.getElementById('back-button');
        const comparatorButton = document.getElementById('comparator-button');
        const headerSubtitle = document.getElementById('header-subtitle');
        const detailedFlowModal = document.getElementById('detailed-flow-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const modalContent = document.getElementById('modal-content');
        const lightboxModal = document.getElementById('lightbox-modal');
        const closeLightboxBtn = document.getElementById('close-lightbox-btn');
        const lightboxImage = document.getElementById('lightbox-image');
        const prevLightboxBtn = document.getElementById('prev-lightbox-btn');
        const nextLightboxBtn = document.getElementById('next-lightbox-btn');
        
        let state = {
            view: 'home', // 'home', 'city', 'property', 'comparator_city_select', 'comparator_results'
            city: null,
            property: null,
            history: [],
        };
        
        let currentLightboxIndex = 0;
        let lightboxImageUrls = [];

        // --- FUNÇÕES AUXILIARES ---
        const formatCurrency = (value) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value);
        const getImovelData = (imovelId) => {
            for (const cityId in dadosPorCidade) {
                for (const status in dadosPorCidade[cityId]) {
                    if (dadosPorCidade[cityId][status][imovelId]) {
                        return dadosPorCidade[cityId][status][imovelId];
                    }
                }
            }
            return null;
        };
        const parseValue = (str) => {
            if (!str || typeof str !== 'string') return null;
            const cleanStr = str.replace(/[^0-9,]/g, '').replace(',', '.');
            return parseFloat(cleanStr) || null;
        };
        const parseArea = (str) => {
            if (!str || typeof str !== 'string') return null;
            const cleanStr = str.replace(/[^0-9,]/g, '').replace(',', '.');
            return parseFloat(cleanStr) || null;
        };
        const getYoutubeEmbedUrl = (url) => {
            if (!url) return null;
            let videoId;
            try {
                const urlObj = new URL(url);
                if (urlObj.hostname === 'youtu.be') {
                    videoId = urlObj.pathname.slice(1);
                } else {
                    videoId = urlObj.searchParams.get('v');
                }
            } catch (e) {
                return null; // Retorna nulo se a URL for inválida
            }
            return videoId ? `https://www.youtube.com/embed/${videoId}` : null;
        };

        // --- FUNÇÕES DE RENDERIZAÇÃO ---

        function renderHomePage() {
            headerSubtitle.textContent = 'Selecione uma cidade para iniciar a análise';
            dashboardContent.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 pt-8">
                    <div class="card !p-0 text-center cursor-pointer city-card" style="background-image: url('https://emcasa.com/blog/wp-content/uploads/2022/05/pexels-sergio-souza-5047706-scaled-1.jpg')" data-action="select-city" data-city="saopaulo">
                        <h2 class="text-4xl font-bold text-white">São Paulo</h2>
                    </div>
                    <div class="card !p-0 text-center cursor-pointer city-card" style="background-image: url('https://cdn.jornalopcao.com.br/assets/2023/10/pontos-turisticos-de-goiania.jpg')" data-action="select-city" data-city="goiania">
                         <h2 class="text-4xl font-bold text-white">Goiânia</h2>
                    </div>
                </div>
            `;
        }
        
        function renderCityPage(cityId) {
            const cityName = cityId === 'saopaulo' ? 'São Paulo' : 'Goiânia';
            headerSubtitle.textContent = `Explorando imóveis em ${cityName}`;
            const cityData = dadosPorCidade[cityId];
            let contentHtml = '';

            const createSection = (title, properties) => {
                if (!properties || Object.keys(properties).length === 0) return '';
                
                const propertyCards = Object.entries(properties).map(([id, prop]) => `
                    <div class="card !p-0 overflow-hidden cursor-pointer" data-action="select-property" data-property="${id}">
                         ${prop.imagens_url && prop.imagens_url.length > 0 ? `<img src="${prop.imagens_url[0]}" alt="Imagem de ${prop.nome}" class="w-full h-40 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/600x400/2E3944/D3D9D4?text=Imagem+Indispon%C3%ADvel';">` : ''}
                        <div class="p-6">
                            <h3 class="text-lg font-bold text-white">${prop.nome}</h3>
                            <p class="text-sm text-gray-400">${prop.localizacao}</p>
                            <p class="text-accent font-semibold mt-2">${prop.valor}</p>
                        </div>
                    </div>
                `).join('');

                return `
                    <section>
                        <h2 class="text-2xl font-bold text-white mb-4 border-b-2 border-accent pb-2">${title}</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            ${propertyCards}
                        </div>
                    </section>
                `;
            };

            contentHtml += createSection('Imóveis Prontos', cityData.prontos);
            contentHtml += createSection('Imóveis em Construção', cityData['em-construcao']);
            
            dashboardContent.innerHTML = contentHtml || '<p class="text-center text-gray-200">Nenhum imóvel encontrado.</p>';
        }

        function renderPropertyPage(propertyId) {
            const imovel = getImovelData(propertyId);
            headerSubtitle.textContent = imovel.nome;
            
            const renderList = (items) => items.map(item => `<li class="list-item"><i class="fa-solid fa-check-circle icon mt-1"></i> <span>${item}</span></li>`).join('');

            const renderCalculator = () => {
                const data = dadosCalculadora[propertyId];
                if (!data || !data.fluxos) return '<p class="text-sm text-gray-400">Nenhuma unidade com fluxo de pagamento detalhado disponível.</p>';

                const unitInputs = data.fluxos.map((fluxo, index) => {
                    const totalValue = fluxo.pagamentos.reduce((sum, p) => sum + p.valor, 0);
                    return `
                    <div class="flex items-center justify-between p-3 bg-[#3E4954] rounded-lg gap-4">
                        <div class="text-sm flex-grow">
                            <span class="font-bold text-white">${fluxo.nome}</span>
                            <span class="text-gray-300 block">${fluxo.info_unidade} | Total: ${formatCurrency(totalValue)}</span>
                        </div>
                        <div class="flex items-center gap-2 flex-shrink-0">
                            <label for="unit-qty-${index}" class="text-sm text-gray-300">Qtd:</label>
                            <input type="number" id="unit-qty-${index}" class="unit-quantity-input w-20 text-center bg-[#212A31] rounded-md border border-gray-600 p-1 text-white" value="0" min="0" data-unit-value="${totalValue}">
                        </div>
                    </div>
                `}).join('');

                return `
                    <div class="space-y-3">${unitInputs}</div>
                    <div class="mt-6 p-4 bg-[#212A31] rounded-lg text-center">
                        <h4 class="text-lg font-semibold text-gray-300">VALOR TOTAL SIMULADO</h4>
                        <p id="total-calculator" class="text-3xl font-bold text-accent mt-1">${formatCurrency(0)}</p>
                    </div>
                `;
            };

             const renderPlantas = () => {
                if (!imovel.plantas || imovel.plantas.length === 0) return '';
                const plantasHtml = imovel.plantas.map((planta, index) => `
                    <div class="text-center">
                        <img src="${planta.url}" alt="Planta de ${planta.descricao}" class="w-full object-contain rounded-lg border-2 border-gray-700 cursor-pointer" data-action="open-lightbox-single" data-src="${planta.url}">
                        <p class="text-sm mt-2 text-gray-300">${planta.descricao}</p>
                    </div>
                `).join('');

                return `
                    <div class="card">
                        <h2 class="text-xl sm:text-2xl font-semibold text-white mb-4">Plantas</h2>
                        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                            ${plantasHtml}
                        </div>
                    </div>
                `;
            };
            
            const renderImageGallery = (imageUrls) => {
                if (!imageUrls || imageUrls.length === 0) return '';
                
                if (imageUrls.length === 1) {
                    return `<div class="card !p-2 flex justify-center items-center mb-6 h-auto md:h-96"><img src="${imageUrls[0]}" alt="Imagem de ${imovel.nome}" class="max-w-full max-h-full object-contain rounded-lg cursor-pointer" data-action="open-lightbox" data-index="0" onerror="this.onerror=null;this.src='https://placehold.co/800x600/2E3944/D3D9D4?text=Imagem+Indispon%C3%ADvel';"></div>`
                }
                
                const mainImage = imageUrls[0];
                const thumb1 = imageUrls[1];
                const thumb2 = imageUrls[2];

                return `
                <div class="card !p-2 mb-6" id="property-image-gallery">
                    <div class="grid grid-cols-3 grid-rows-2 gap-2 h-[50vh] max-h-[450px]">
                        <div class="col-span-2 row-span-2">
                            <img src="${mainImage}" data-action="open-lightbox" data-index="0" alt="Fachada de ${imovel.nome}" class="w-full h-full object-cover rounded-lg cursor-pointer" onerror="this.onerror=null;this.src='https://placehold.co/800x600/2E3944/D3D9D4?text=Imagem+Indispon%C3%ADvel';">
                        </div>
                        ${thumb1 ? `<div class="col-span-1 row-span-1">
                             <img src="${thumb1}" data-action="open-lightbox" data-index="1" alt="Detalhe de ${imovel.nome} 1" class="w-full h-full object-cover rounded-lg cursor-pointer" onerror="this.onerror=null;this.src='https://placehold.co/400x400/2E3944/D3D9D4?text=Imagem';">
                        </div>` : ''}
                        ${thumb2 ? `<div class="col-span-1 row-span-1">
                             <img src="${thumb2}" data-action="open-lightbox" data-index="2" alt="Detalhe de ${imovel.nome} 2" class="w-full h-full object-cover rounded-lg cursor-pointer" onerror="this.onerror=null;this.src='https://placehold.co/400x400/2E3944/D3D9D4?text=Imagem';">
                        </div>` : ''}
                    </div>
                </div>
                `;
            };
            
            const additionalInfoGridCols = imovel.ultratour_url ? 'sm:grid-cols-4' : 'sm:grid-cols-3';

            const youtubeEmbedUrl = getYoutubeEmbedUrl(imovel.video_url);

            dashboardContent.innerHTML = `
                ${renderImageGallery(imovel.imagens_url)}
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
                    <div class="lg:col-span-3 space-y-6">
                        <div class="card">
                            <h2 class="text-xl font-semibold text-white mb-4">Sobre o Imóvel</h2>
                            <p class="text-sm text-gray-200 leading-relaxed">${imovel.descricao_longa}</p>
                            ${imovel.adicionais ? `<div class="mt-4 text-xs text-gray-400 italic"><p>${imovel.adicionais}</p></div>` : ''}
                        </div>
                        <div class="card">
                            <h2 class="text-xl font-semibold text-white mb-4">Geradores de Demanda</h2>
                            <ul class="list-none space-y-3 text-sm text-gray-200">${renderList(imovel.geradores_demanda)}</ul>
                        </div>
                    </div>
                    <div class="lg:col-span-2 space-y-6">
                        <div class="card">
                            <h2 class="text-xl font-semibold text-white mb-4">Detalhes</h2>
                            <div class="space-y-3 text-gray-200 text-sm">
                               <p class="flex items-center gap-2"><i class="fa-solid fa-building icon w-4 text-center"></i> <span class="font-bold">Incorporadora:</span> ${imovel.incorporadora}</p>
                               <p class="flex items-center gap-2"><i class="fa-solid fa-map-marker-alt icon w-4 text-center"></i> <span class="font-bold">Localização:</span> ${imovel.localizacao}</p>
                               <p class="flex items-center gap-2"><i class="fa-solid fa-ruler-combined icon w-4 text-center"></i> <span class="font-bold">Área:</span> ${imovel.area}</p>
                               <p class="flex items-center gap-2"><i class="fa-solid fa-dollar-sign icon w-4 text-center"></i> <span class="font-bold">Valor:</span> ${imovel.valor_de ? `<span class="line-through text-gray-400">${imovel.valor_de}</span> <span class="font-bold text-red-500">${imovel.valor}</span>` : imovel.valor}</p>
                            </div>
                        </div>
                         <div class="card">
                            <h2 class="text-xl font-semibold text-white mb-2">Rendimento Bruto</h2>
                            <p class="text-3xl font-extrabold text-accent">${imovel.rendimento_bruto || 'N/A'}</p>
                            <div class="mt-4 text-sm space-y-2 text-gray-200">
                                <p><span class="font-bold">Diária média:</span> ${imovel.rendimento.diaria_media}</p>
                                <p><span class="font-bold">Faturamento bruto mensal:</span> ${imovel.rendimento.faturamento_bruto_mensal}</p>
                            </div>
                        </div>
                         ${imovel.correcoes ? `<div class="card">
                                <h2 class="text-xl font-semibold text-white mb-2">Correções</h2>
                                <div class="text-sm text-gray-300 space-y-2">
                                     ${imovel.correcoes.obra ? `<p><span class="font-semibold text-red-500">Durante a obra:</span> ${imovel.correcoes.obra}</p>` : ''}
                                     ${imovel.correcoes.pos_habite_se ? `<p><span class="font-semibold text-red-500">Pós Habite-se:</span> ${imovel.correcoes.pos_habite_se}</p>` : ''}
                                     ${imovel.correcoes.despesas_cliente ? `<p class="text-xs italic mt-2">${imovel.correcoes.despesas_cliente}</p>` : ''}
                                </div>
                            </div>` : ''}
                    </div>
                </div>
                <div class="card">
                    <h2 class="text-xl sm:text-2xl font-semibold text-white mb-4">Calculadora de Investimento</h2>
                    <p class="text-sm text-gray-300 mb-4">Insira a quantidade de unidades que deseja simular para calcular o investimento total.</p>
                    <div id="calculator-container">${renderCalculator()}</div>
                </div>
                ${renderPlantas()}
                 <div class="card">
                    <h2 class="text-xl sm:text-2xl font-semibold text-white mb-4">Localização</h2>
                    <div class="aspect-w-16 aspect-h-9 rounded-lg overflow-hidden border-2 border-gray-700">
                         <iframe 
                            class="w-full h-full"
                            style="border:0;"
                            frameborder="0"
                            loading="lazy"
                            allowfullscreen
                            src="https://maps.google.com/maps?q=${imovel.mapa_query}&t=&z=15&ie=UTF8&iwloc=&output=embed">
                         </iframe>
                    </div>
                </div>
                ${youtubeEmbedUrl ? `
                    <div class="card">
                        <h2 class="text-xl sm:text-2xl font-semibold text-white mb-4">Vídeo do Empreendimento</h2>
                        <div class="video-container">
                            <iframe src="${youtubeEmbedUrl}" title="Vídeo do YouTube" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </div>
                ` : ''}
                 <div class="card">
                    <h2 class="text-xl sm:text-2xl font-semibold text-white mb-4">Informações Adicionais</h2>
                    <div class="grid grid-cols-1 ${additionalInfoGridCols} gap-4 text-center">
                        <a href="${imovel.drive_url || '#'}" target="_blank" class="flex flex-col items-center justify-center p-4 bg-[#3E4954] rounded-lg hover:bg-accent transition-colors">
                            <i class="fas fa-book-open text-3xl mb-2"></i><span class="font-semibold text-sm">Book</span>
                        </a>
                        <a href="${imovel.images_url || '#'}" target="_blank" class="flex flex-col items-center justify-center p-4 bg-[#3E4954] rounded-lg hover:bg-accent transition-colors">
                            <i class="fas fa-images text-3xl mb-2"></i><span class="font-semibold text-sm">Imagens</span>
                        </a>
                        ${imovel.ultratour_url ? `<a href="${imovel.ultratour_url}" target="_blank" class="flex flex-col items-center justify-center p-4 bg-[#3E4954] rounded-lg hover:bg-accent transition-colors">
                            <i class="fas fa-vr-cardboard text-3xl mb-2"></i><span class="font-semibold text-sm">Ultratour</span>
                        </a>` : ''}
                        <button data-action="show-detailed-flow" id="detailed-flow-btn" class="flex flex-col items-center justify-center p-4 bg-[#3E4954] rounded-lg hover:bg-accent transition-colors">
                             <i class="fas fa-stream text-3xl mb-2"></i><span class="font-semibold text-sm">Fluxo Detalhado</span>
                        </button>
                    </div>
                </div>
            `;
        }
        
        function renderComparatorCitySelect() {
            headerSubtitle.textContent = 'Selecione uma cidade para comparar os imóveis';
            dashboardContent.innerHTML = `
                <div class="text-center mb-8">
                     <h2 class="text-3xl font-bold text-white">Comparativo de Imóveis</h2>
                     <p class="text-gray-300">Análise de indicadores chave para ajudar na sua decisão</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 pt-8">
                    <div class="card text-center cursor-pointer" data-action="run-comparison" data-city="saopaulo">
                        <i class="fas fa-city text-5xl mb-4 text-accent"></i>
                        <h2 class="text-3xl font-bold text-white">São Paulo</h2>
                    </div>
                    <div class="card text-center cursor-pointer" data-action="run-comparison" data-city="goiania">
                        <i class="fas fa-city text-5xl mb-4 text-accent"></i>
                        <h2 class="text-3xl font-bold text-white">Goiânia</h2>
                    </div>
                </div>
            `;
        }

        function renderComparatorResultsPage(cityId) {
            const cityName = cityId === 'saopaulo' ? 'São Paulo' : 'Goiânia';
            headerSubtitle.textContent = `Comparativo de Imóveis em ${cityName}`;

            const allProperties = { ...dadosPorCidade[cityId].prontos, ...dadosPorCidade[cityId]['em-construcao'] };
            
            const processedData = Object.values(allProperties).map(prop => {
                const area = parseArea(prop.area);
                const valor = parseValue(prop.valor);
                const rendimento = parseValue(prop.rendimento_bruto);
                return {
                    ...prop,
                    areaNum: area,
                    valorNum: valor,
                    rendimentoNum: rendimento,
                    custoM2: (area && valor) ? (valor / area) : null,
                };
            }).filter(p => p.valorNum && p.areaNum); // Only compare properties with valid area and value

            if (processedData.length === 0) {
                dashboardContent.innerHTML = '<p class="text-center text-gray-200">Não há dados suficientes para comparar os imóveis nesta cidade.</p>';
                return;
            }

            const findBest = (metric, order = 'desc') => {
                return processedData.filter(p => p[metric] != null).sort((a, b) => order === 'desc' ? b[metric] - a[metric] : a[metric] - b[metric])[0];
            };

            const best = {
                menorValor: findBest('valorNum', 'asc'),
                maiorArea: findBest('areaNum', 'desc'),
                melhorRendimento: findBest('rendimentoNum', 'desc'),
                melhorCustoM2: findBest('custoM2', 'asc'),
            };

            const createResultCard = (title, icon, property, value, unit) => {
                if (!property) return '';
                return `
                    <div class="card text-center">
                        <i class="fas ${icon} text-4xl text-accent mb-3"></i>
                        <h3 class="text-xl font-bold text-white">${title}</h3>
                        <p class="text-2xl font-bold text-accent mt-2">${value} <span class="text-base font-normal text-gray-300">${unit}</span></p>
                        <div class="mt-4 pt-4 border-t border-gray-700">
                            <p class="font-semibold text-white">${property.nome}</p>
                            <p class="text-sm text-gray-400">${property.localizacao}</p>
                        </div>
                    </div>
                `;
            };

            dashboardContent.innerHTML = `
                 <div class="text-center mb-8">
                     <h2 class="text-3xl font-bold text-white">Resultados para ${cityName}</h2>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    ${createResultCard('Menor Valor', 'fa-dollar-sign', best.menorValor, formatCurrency(best.menorValor?.valorNum), '')}
                    ${createResultCard('Maior Área', 'fa-ruler-combined', best.maiorArea, best.maiorArea?.areaNum, 'm²')}
                    ${createResultCard('Melhor Rendimento', 'fa-chart-line', best.melhorRendimento, formatCurrency(best.melhorRendimento?.rendimentoNum), '/mês')}
                    ${createResultCard('Melhor Custo-Benefício', 'fa-gem', best.melhorCustoM2, formatCurrency(best.melhorCustoM2?.custoM2), '/m²')}
                </div>
            `;
        }

        // --- MODAL & FLUXO DETALHADO ---
        function hideModal() {
            detailedFlowModal.classList.add('hidden');
        }

        function renderDetailedFlow() {
            const calculatorContainer = document.getElementById('calculator-container');
            if (!calculatorContainer) return;

            const inputs = calculatorContainer.querySelectorAll('.unit-quantity-input');
            const paymentsByMonth = {};
            let totalUnits = 0;

            inputs.forEach((input, index) => {
                const quantity = parseInt(input.value) || 0;
                if (quantity > 0) {
                    totalUnits += quantity;
                    const fluxo = dadosCalculadora[state.property].fluxos[index];
                    fluxo.pagamentos.forEach(p => {
                        const monthKey = `${p.data.getFullYear()}-${String(p.data.getMonth() + 1).padStart(2, '0')}`;
                        if (!paymentsByMonth[monthKey]) {
                            paymentsByMonth[monthKey] = { total: 0, descriptions: {} };
                        }
                        paymentsByMonth[monthKey].total += p.valor * quantity;
                        
                        const descKey = p.descricao;
                        if (!paymentsByMonth[monthKey].descriptions[descKey]) {
                            paymentsByMonth[monthKey].descriptions[descKey] = 0;
                        }
                        paymentsByMonth[monthKey].descriptions[descKey] += quantity;
                    });
                }
            });

            if (totalUnits === 0) {
                modalContent.innerHTML = `<p class="text-center text-gray-300 py-8">Por favor, insira a quantidade de uma ou mais unidades na calculadora para ver o fluxo de pagamento detalhado.</p>`;
            } else {
                const sortedMonths = Object.keys(paymentsByMonth).sort();
                const tableRows = sortedMonths.map(monthKey => {
                    const data = paymentsByMonth[monthKey];
                    const [year, month] = monthKey.split('-');
                    const monthName = new Date(year, month - 1, 1).toLocaleDateString('pt-BR', { month: 'long', year: 'numeric' });
                    
                    const descString = Object.entries(data.descriptions)
                                            .map(([desc, qty]) => `${desc} (x${qty})`)
                                            .join(', ');

                    return `
                        <tr class="border-b border-gray-700 hover:bg-gray-800">
                            <td class="p-3 font-semibold text-white capitalize whitespace-nowrap">${monthName}</td>
                            <td class="p-3 text-accent font-bold whitespace-nowrap">${formatCurrency(data.total)}</td>
                            <td class="p-3 text-sm text-gray-300">${descString}</td>
                        </tr>
                    `;
                }).join('');

                modalContent.innerHTML = `
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="sticky top-0 bg-[#2E3944]">
                                <tr class="border-b border-gray-600">
                                    <th class="p-3 text-sm font-bold uppercase text-gray-400">Mês/Ano</th>
                                    <th class="p-3 text-sm font-bold uppercase text-gray-400">Valor a Pagar</th>
                                    <th class="p-3 text-sm font-bold uppercase text-gray-400">Descrição das Parcelas</th>
                                </tr>
                            </thead>
                            <tbody>${tableRows}</tbody>
                        </table>
                    </div>
                `;
            }
            
            detailedFlowModal.classList.remove('hidden');
        }

        // --- LÓGICA DO LIGHTBOX ---
        function showLightboxImage(index) {
            if (index < 0 || index >= lightboxImageUrls.length) return;
            currentLightboxIndex = index;
            lightboxImage.src = lightboxImageUrls[index];
            prevLightboxBtn.classList.toggle('hidden', index === 0);
            nextLightboxBtn.classList.toggle('hidden', index === lightboxImageUrls.length - 1);
        }

        function openLightbox(startIndex, urls) {
             if (!urls || urls.length === 0) return;
            
            lightboxImageUrls = urls;
            
            if (lightboxImageUrls.length > 0) {
                showLightboxImage(startIndex);
                lightboxModal.classList.remove('hidden');
            }
        }


        function closeLightbox() {
            lightboxModal.classList.add('hidden');
        }
        
        // --- CONTROLE DE NAVEGAÇÃO E ESTADO ---
        function updateUI() {
            backButton.classList.toggle('hidden', state.history.length === 0);
            comparatorButton.classList.toggle('hidden', state.view !== 'home');

            switch (state.view) {
                case 'home': renderHomePage(); break;
                case 'city': renderCityPage(state.city); break;
                case 'property': renderPropertyPage(state.property); break;
                case 'comparator_city_select': renderComparatorCitySelect(); break;
                case 'comparator_results': renderComparatorResultsPage(state.city); break;
            }
        }

        function navigateTo(newState) {
            state.history.push({ ...state });
            Object.assign(state, newState);
            updateUI();
        }

        function goBack() {
            if (state.history.length > 0) {
                state = state.history.pop();
                updateUI();
            }
        }
        
        // --- LÓGICA DA CALCULADORA ---
        function calculateTotal() {
            const container = document.getElementById('calculator-container');
            if (!container) return;

            const inputs = container.querySelectorAll('.unit-quantity-input');
            let total = 0;

            inputs.forEach(input => {
                const quantity = parseInt(input.value) || 0;
                const unitValue = parseFloat(input.dataset.unitValue);
                if (quantity > 0 && unitValue) {
                    total += quantity * unitValue;
                }
            });

            document.getElementById('total-calculator').textContent = formatCurrency(total);
        }

        // --- EVENT LISTENERS ---

        dashboardContent.addEventListener('click', (e) => {
            const target = e.target.closest('[data-action]');
            if (!target) return;

            const { action, city, property } = target.dataset;

            if (action === 'select-city') navigateTo({ view: 'city', city: city });
            else if (action === 'select-property') navigateTo({ view: 'property', property: property });
            else if (action === 'run-comparison') navigateTo({ view: 'comparator_results', city: city });
            else if (action === 'show-detailed-flow') renderDetailedFlow();
            else if (action === 'open-lightbox') {
                 const imovel = getImovelData(state.property);
                 openLightbox(parseInt(target.dataset.index, 10), imovel.imagens_url);
            } else if (action === 'open-lightbox-single') {
                 openLightbox(0, [target.dataset.src]);
            }
        });

        dashboardContent.addEventListener('input', (e) => {
            if (e.target.classList.contains('unit-quantity-input')) {
                calculateTotal();
            }
        });

        backButton.addEventListener('click', goBack);
        
        comparatorButton.addEventListener('click', () => {
             navigateTo({ view: 'comparator_city_select' });
        });

        closeModalBtn.addEventListener('click', hideModal);
        detailedFlowModal.addEventListener('click', (e) => {
            if (e.target === detailedFlowModal) {
                hideModal();
            }
        });
        
        closeLightboxBtn.addEventListener('click', closeLightbox);
        lightboxModal.addEventListener('click', (e) => {
            if (e.target === lightboxModal) {
                closeLightbox();
            }
        });
        prevLightboxBtn.addEventListener('click', () => showLightboxImage(currentLightboxIndex - 1));
        nextLightboxBtn.addEventListener('click', () => showLightboxImage(currentLightboxIndex + 1));
        
        document.addEventListener('keydown', (e) => {
            if (!lightboxModal.classList.contains('hidden')) {
                if (e.key === 'Escape') closeLightbox();
                if (e.key === 'ArrowLeft') showLightboxImage(currentLightboxIndex - 1);
                if (e.key === 'ArrowRight') showLightboxImage(currentLightboxIndex + 1);
            }
        });


        // --- INICIALIZAÇÃO ---
        window.addEventListener('load', updateUI);

    </script>
</body>
</html>

